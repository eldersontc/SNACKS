<div class="form-inline mb-3">
  <div class="input-group col-md-4  mb-2 justify-content-center">
    <select class="custom-select" [(ngModel)]="criterio">
      <option [ngValue]="1">Título</option>
    </select>
    <input type="text" class="form-control" [(ngModel)]="busqueda">
    <div class="input-group-append">
      <button class="btn btn-primary" type="button" (click)="buscar()">
        <fa name="search"></fa>
      </button>
    </div>
  </div>
  <div class="btn-group col-md-4  mb-2 justify-content-center">
    <span class="ml-2" *ngFor="let filtro of filtros">
      <button type="button" class="btn badge badge-pill badge-secondary" (click)="quitarFiltro(filtro)" ngbPopover="Eliminar filtro" triggers="mouseenter:mouseleave">
        {{filtro.v}} <fa name="times-circle"></fa>
      </button>
    </span>
  </div>
  <div class="btn-group col-md-4 mb-2 justify-content-center" role="group" aria-label="First group" *ngIf="!include">
    <button type="button" class="btn btn-primary" [routerLink]='["/reportes-form"]'>
      <fa name="plus-circle"></fa> Nuevo
    </button>
    <button type="button" class="btn btn-primary" [disabled]="!seleccion" [routerLink]='["/reportes-form/" + ((seleccion) ? seleccion.idReporte : 0)]'>
      <fa name="edit"></fa> Editar
    </button>
    <button type="button" class="btn btn-primary" [disabled]="!seleccion" (click)="open(content)">
      <fa name="trash"></fa> Eliminar
    </button>
    <button type="button" class="btn btn-primary" [disabled]="!seleccion" (click)="getReporte(viewer)">
      <fa name="chart"></fa> Reporte
    </button>
  </div>
  <div class="btn-group col-md-4 mb-2 justify-content-center" role="group" aria-label="First group" *ngIf="include">
    <button type="button" class="btn btn-primary" [disabled]="!seleccion" (click)="elegir()">
      <fa name="undo"></fa> Seleccionar
    </button>
    <button type="button" class="btn btn-primary" (click)="cancelar()">
      <fa name="times-circle"></fa> Regresar
    </button>
  </div>
</div>

<table class="table table-bordered table-hover table-sm">
  <thead class="thead-light">
    <tr>
      <th scope="col"></th>
      <th scope="col">Nro.</th>
      <th scope="col">Título</th>
      <th scope="col">Tipo</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let r of reportes; let idx = index">
      <td>
        <div class="custom-control custom-radio text-center">
          <input type="radio" [id]="idx" name="customRadio" class="custom-control-input" [value]="r" [(ngModel)]="seleccion">
          <label class="custom-control-label" [for]="idx">
            <span class="text-hide">.</span>
          </label>
        </div>
      </td>
      <td>{{r.idReporte}}</td>
      <td>{{r.titulo}}</td>
      <td>{{r.tipoReporte}}</td>
    </tr>
  </tbody>
</table>

<ngb-pagination class="d-flex justify-content-center"
                [collectionSize]="totalRegistros"
                [(page)]="pagina"
                [maxSize]="5"
                [rotate]="true"
                [ellipses]="false"
                [boundaryLinks]="true"
                (pageChange)="pageChange()"></ngb-pagination>

<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header bg-primary text-white">
    <h5 class="modal-title" id="modal-basic-title"><fa name="exclamation-triangle"></fa> Confirmación</h5>
    <button type="button" class="close" aria-label="Close" (click)="c('Cerrar')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-footer justify-content-center">
    <button type="button" class="btn btn-primary" (click)="c('Eliminar')"><fa name="trash"></fa> Eliminar</button>
    <button type="button" class="btn btn-secoundary" (click)="c('Cancelar')">Cancelar</button>
  </div>
</ng-template>

<ng-template #viewer let-c="close" let-d="dismiss">
  <div class="modal-header bg-primary text-white">
    <h5 class="modal-title" id="modal-basic-title"><!--<fa name="exclamation-triangle"></fa>--> Ver Reporte</h5>
    <button type="button" class="close" aria-label="Close" (click)="c('Cerrar')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div *ngIf="!view">
      <table class="table table-bordered table-hover table-sm">
        <thead class="thead-light">
          <tr>
            <th scope="col">Parámetro</th>
            <th scope="col">Valor</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let i of reporteView.items">
            <td>{{i.nombre}}</td>
            <td>
              <input type="text" class="form-control" [(ngModel)]="i.valor" />
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="chart">
      <canvas id="canvas">{{ chart }}</canvas>
    </div>
  </div>
  <div class="modal-footer justify-content-center">
    <button type="button" class="btn btn-primary" (click)="runReporte()" [hidden]="view">
      <fa name="trash"></fa> Generar
    </button>
    <!--<button type="button" class="btn btn-primary" (click)="exportReporte()" [hidden]="!view">
      <fa name="trash"></fa> Exportar
    </button>-->
    <button type="button" class="btn btn-secoundary" (click)="c('Cancelar')">
      Cancelar
    </button>
  </div>
</ng-template>
